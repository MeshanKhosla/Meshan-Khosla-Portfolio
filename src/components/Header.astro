---
import ThemeToggle from './ThemeToggle.astro';

interface Props {
  currentPath?: string;
}

const { currentPath = '' } = Astro.props;

const navLinks = [
  { href: '/', label: 'Home' },
  { href: '/blog', label: 'Blog' },
  { href: '/projects', label: 'Projects' },
  { href: '/experience', label: 'Experience' },
];

const isActive = (href: string) => {
  if (href === '/') {
    return currentPath === '/';
  }
  return currentPath.startsWith(href);
};
---

<header class="sticky top-0 z-50 backdrop-blur-md bg-cream-100/80 dark:bg-ink/80 border-b border-cream-300 dark:border-ink-lighter">
  <nav class="container-wide py-4">
    <div class="flex items-center justify-between">
      <!-- Logo / Name -->
      <a
        href="/"
        class="font-serif text-xl font-semibold text-charcoal dark:text-sand
               hover:text-accent dark:hover:text-accent-light transition-colors"
      >
        Meshan Khosla
      </a>

      <!-- Navigation Links -->
      <div class="flex items-center gap-1">
        <ul class="hidden sm:flex items-center gap-1">
          {navLinks.map((link) => (
            <li>
              <a
                href={link.href}
                class:list={[
                  'px-3 py-2 rounded-md text-sm font-medium transition-colors',
                  isActive(link.href)
                    ? 'text-accent dark:text-accent-light bg-cream-200 dark:bg-ink-lighter'
                    : 'text-charcoal-muted dark:text-sand-muted hover:text-charcoal dark:hover:text-sand hover:bg-cream-200 dark:hover:bg-ink-lighter',
                ]}
              >
                {link.label}
              </a>
            </li>
          ))}
        </ul>

        <!-- Mobile menu button -->
        <button
          id="mobile-menu-btn"
          type="button"
          class="sm:hidden p-2 rounded-md hover:bg-cream-200 dark:hover:bg-ink-lighter"
          aria-label="Toggle menu"
        >
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>

        <div class="w-px h-6 bg-cream-300 dark:bg-ink-lighter mx-2 hidden sm:block"></div>
        
        <ThemeToggle />
      </div>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden sm:hidden mt-4 pb-2">
      <ul class="flex flex-col gap-1">
        {navLinks.map((link) => (
          <li>
            <a
              href={link.href}
              class:list={[
                'block px-3 py-2 rounded-md text-sm font-medium transition-colors',
                isActive(link.href)
                  ? 'text-accent dark:text-accent-light bg-cream-200 dark:bg-ink-lighter'
                  : 'text-charcoal-muted dark:text-sand-muted hover:text-charcoal dark:hover:text-sand hover:bg-cream-200 dark:hover:bg-ink-lighter',
              ]}
            >
              {link.label}
            </a>
          </li>
        ))}
      </ul>
    </div>
  </nav>
</header>

<script>
  function setupMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    if (!btn || !menu) return;

    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
    });
  }

  setupMobileMenu();
</script>
